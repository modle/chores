{% extends 'base.html' %}
{% load markdown_deux_tags %}
{% load chores_extras %}

{% block content %}
<div class="hero-unit">
    <h1>{{ user.username }}'s Chores</h1>
</div>

{{ message }}
<div class="container-fluid">
    <button type="button" class="btn" data-toggle="collapse" data-target=".newpost-collapse">Add a Chore</button>
    <div class="newpost-collapse collapse">
        <form method="POST" action="">
            {% csrf_token %}
            {{ form }}
            <p>
                <input class="btn" type="submit" value="Submit &raquo;" id="submit"/>
            </p>
        </form>
    </div>
</div>

<hr noshade>

{% for chore in chores %}
{% if chore.last_completed_date|overdue:chore.frequency_in_days >= 0 %}
    <div class="row-fluid">
        <div class="span12">
            <p><b>{{ chore.title }}</b> - <span class="small-caps-header">{{ chore.category }}</span></p>
            {% if chore.last_completed_date|overdue:chore.frequency_in_days != 999 %}
                <p>Last Completed by <span class="small-caps-header">{{ chore.last_completed_by }}</span> on
                <span class="small-caps-header">{{ chore.last_completed_date|date:"l" }} | {{ chore.last_completed_date|date }}</span></p>
            {% endif %}
            <p>
                {% if chore.last_completed_date|overdue:chore.frequency_in_days = 999 %}
                    Overdue by: <span class="small-caps-header">Too long</span> |
                {% elif chore.last_completed_date|overdue:chore.frequency_in_days = 0 %}
                    Due: <span class="small-caps-header">Today</span> |
                {% else %}
                    Overdue: <span class="small-caps-header">{{ chore.last_completed_date|overdue:chore.frequency_in_days }} day(s)</span> |
                {% endif %}
                Frequency: <span class="small-caps-header">{{ chore.frequency_in_days }} day(s)</span>
            </p>
            <p>Priority:
            {% if chore.priority = 1 %}
                <span style="color:red; font-weight:bold">{{ chore.get_priority_display }}</span>
            {% elif chore.priority = 2 %}
                <span style="color:#FFB90F; font-weight:bold">{{ chore.get_priority_display }}</span>
            {% else %}
                <span style="color:green; font-weight:bold">{{ chore.get_priority_display }}</span>
            {% endif %}
            </p>
            <p><a class="btn" href="{% url 'mark_chore_done' chore.slug %}">Mark Done &raquo;</a></p>
            <hr>
        </div><!--/span-->
    </div><!--/row-->
{% endif %}
{% endfor %}

{% endblock %}

{% block navsidebar %}
{% endblock %}
